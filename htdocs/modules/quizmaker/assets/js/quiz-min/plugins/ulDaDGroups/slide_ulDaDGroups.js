class ulDaDGroups extends quizPrototype{name="ulDaDGroups";build(){this.boolDog=false;return this.getInnerHTML();}reloadQuestion(){var currentQuestion=this.question;var obGroups=[];var obGroup;var nbGroups=this.data.groupsLib.length;var groupIndex=-1;for(k=0;k < this.data.groupsLib.length;k++){obGroups[k]=document.getElementById(this.getId('group',k));}for(var k in currentQuestion.answers){var ans=currentQuestion.answers[k];groupIndex=(currentQuestion.options.groupDefault*1 < 0)? rnd(nbGroups-1):currentQuestion.options.groupDefault;obGroup=obGroups[groupIndex];obGroup.appendChild(document.getElementById(ans.id));}return true;}getInnerHTML(){var currentQuestion=this.question;var tWords=[];var tPoints=[];var tItems=new Object;var img='';var src='';var captionTop='';var captionBottom='';var divHeight=currentQuestion.options.imgHeight1*1+12;var posCaption=currentQuestion.options.showCaptions;var ImgStyle=`style="height:${divHeight}px;"`;var nbGroups=this.data.groupsLib.length;var tpl=this.getDisposition(currentQuestion.options.disposition,'ulDaDGroups');var groups=[];var ans;var groupIndex;for(var k=0;k < nbGroups;k++){groups[k]=[];}for(var k in currentQuestion.answers){groupIndex=(currentQuestion.options.groupDefault*1 < 0)? rnd(nbGroups-1):currentQuestion.options.groupDefault;groups[groupIndex].push(currentQuestion.answers[k]);}for(var k=0;k < nbGroups;k++){var tHtml=[];var groupName=this.getId('group',k);for(var j=0;j < groups[k].length;j++){ans=groups[k][j];switch(posCaption){case 'T':captionTop=ans.caption.replace(' ','<br>')+'<br>';break;case 'B':captionBottom='<br>'+ans.caption.replace(' ','<br>');break;default:break;}var backGround=(ans.background)? `background:${ans.background};`:'';tHtml.push(`<li id='${ans.id}' class='quiz_slist' style='width:${currentQuestion.options.ulWidth}%;${backGround}'>${ans.proposition}</li>${captionBottom}`);}tpl=tpl.replace(`{contentGroup${k}}`,tHtml.join("\n"));}for(var k=0;k < this.data.groupsLib.length;k++){tpl=tpl.replace(`{libGroup${k}}`,this.data.groupsLib[k]);}return tpl;}initSlide(){var nbGroups=4;for(var k=0;k < nbGroups;k++){var groupName=this.getId('group',k);var obGroup=document.getElementById(groupName);if(obGroup){this.init_slist(obGroup);}}return true;}init_slist(target){target.classList.add("quiz_ulDaDGroups_slist");let items=target.getElementsByTagName("li"),current=null;for(let i of items){i.draggable=true;i.ondragstart=e=>{e.dataTransfer.effectAllowed="move";e.dataTransfer.setData("text",e.target.getAttribute("id"));console.log('init_slist.start===>'+e.target.getAttribute("id"));}};}prepareData(){var currentQuestion=this.question;var groups=[];groups[0]=[];for(var k in currentQuestion.answers){var ans=currentQuestion.answers[k];ans.id=this.getId('item',k);if(ans.points==0){ans.points=1;}if(!groups[ans.group*1])groups[ans.group*1]=[];groups[ans.group*1].push(ans);}this.data.groups=groups;this.data.groupsLib=[];for(var k=0;k <=3;k++){var key='group'+k;if(currentQuestion.options[key]){this.data.groupsLib.push(currentQuestion.options[key]);}}this.data.urlCommonImg=quiz_config.urlCommonImg;}getScoreByProposition(answerContainer){var points=0;var ans;var obAns;var idDivGood;var currentQuestion=this.question;this.blob('showGoodAnswers-----------------------------------------');for(var k=0;k < currentQuestion.answers.length;k++){ans=currentQuestion.answers[k];obAns=document.getElementById(ans.id);idDivGood=this.getId('group',ans.group);if(idDivGood==obAns.parentNode.id){points+=ans.points*1;}else{}}return points;}computeScoresMinMaxByProposition(){var currentQuestion=this.question;var score={min:0,max:0};for(var k in currentQuestion.answers){var points=currentQuestion.answers[k].points;if(points==0){points=1;}if(points > 0){this.scoreMaxiBP+=parseInt(points)*1;}if(points < 0){this.scoreMiniBP+=parseInt(points)*1;}}return true;}getAllReponses(flag=0){var currentQuestion=this.question;var img='';var src='';var captionTop='';var captionBottom='';var divHeight=currentQuestion.options.imgHeight1*1+12;var posCaption=currentQuestion.options.showCaptions;var divStyle=`style="float:left;margin:5px;font-size:0.8em;text-align:center;"`;var ImgStyle=`style="height:${divHeight}px;"`;var nbGroups=this.data.groupsLib.length;var groups=[];var ans;var index;for(var k=0;k < nbGroups;k++){groups[k]=[];}for(var k in currentQuestion.answers){var ans=currentQuestion.answers[k];var g=ans.group;switch(posCaption){case 'T':captionTop=ans.caption.replace(' ','<br>')+'<br>';break;case 'B':captionBottom='<br>'+ans.caption.replace(' ','<br>');break;default:break;}groups[g].push(`<li id='${ans.id}' class='quiz_slist'>${ans.proposition}</li>${captionBottom}`);}var tHtml=[];for(var k=0;k < nbGroups;k++){tHtml.push('<div style="clear:both;color:red;"><hr>'+this.data.groupsLib[k]+'</div>');tHtml.push(groups[k].join(''));}return tHtml.join("\n");}showGoodAnswers(){var currentQuestion=this.question;var obGroups=[];var obGroup;for(k=0;k < this.data.groupsLib.length;k++){var groupName=this.getId('group',k);obGroups.push(document.getElementById(groupName));}for(var k in currentQuestion.answers){var ans=currentQuestion.answers[k];var obGroup=obGroups[ans.group];obGroup.appendChild(document.getElementById(ans.id));}return true;}showBadAnswers(){var currentQuestion=this.question;var obGroups=[];var obGroup;var nbGroups=this.data.groupsLib.length;var index;for(k=0;k < this.data.groupsLib.length;k++){obGroups[k]=document.getElementById(this.getId('group',k));}for(var k in currentQuestion.answers){var ans=currentQuestion.answers[k];index=rnd(nbGroups-1);obGroup=obGroups[index];if(obGroup){obGroup.appendChild(document.getElementById(ans.id));}}return true;}getDisposition(disposition,tableId){var currentQuestion=this.question;var DadEvent=`onDragOver="return ulDaDGroups_dad_over(event);"onDrop="return ulDaDGroups_dad_drop(event,${quiz_config.dad_move_img});"onDragLeave="ulDaDGroups_dad_leave(event);"`;var tdStyle='width:100%;';var tpl='';var groupes=[];for(var h=0;h < 4;h++){var bg=currentQuestion.options[`bgGroup${h}`];var id=this.getId('group',h);groupes.push(`<span style="background:${bg};">{libGroup${h}}</span><br><div id='${id}' class='myimg0' attSelGroup style="background:${bg}" ${DadEvent}>{contentGroup${h}}</div>`);}switch(disposition){case 'disposition-02':tdStyle='width:50%;';tpl=`<table class='${tableId}'><tbody><tr><td style='${tdStyle}'>${groupes[0]}</td><td style='${tdStyle}'>${groupes[1]}</td></tr></tbody></table>`;break;case 'disposition-03':tdStyle='width:33%;';tpl=`<table class='${tableId}'><tbody><tr><td style='${tdStyle}'>${groupes[0]}</td><td style='${tdStyle}'>${groupes[1]}</td><td style='${tdStyle}'>${groupes[2]}</td></tr></tbody></table>`;break;case 'disposition-12':tdStyle='width:50%;';tpl=`<table class='${tableId}'><tbody><tr><td colspan="2" rowspan="1" '${tdStyle}'>${groupes[0]}</td></tr><tr><td style='${tdStyle}'${groupes[1]}</td><td style='${tdStyle}'>${groupes[2]}</td></tr></tbody></table>`;break;case 'disposition-13':tdStyle='width:33%;';tpl=`<table class='${tableId}'><tbody><tr><td colspan="3" rowspan="1" style='${tdStyle}'${groupes[0]}</td></tr><tr><td style='${tdStyle}'>${groupes[1]}</td><td style='${tdStyle}'>${groupes[2]}</td><td style='${tdStyle}'>${groupes[3]}</td></tr></tbody></table>`;break;case 'disposition-20':tdStyle='width:100%;';tpl=`<table class='${tableId}'><tbody><tr><td style='${tdStyle}'>${groupes[0]}</td></tr><tr><td style='${tdStyle}'>${groupes[1]}</td></tr></tbody></table>`;break;case 'disposition-21':tdStyle='width:50%;';tpl=`<table class='${tableId}'><tbody><tr><td colspan="1" rowspan="2" style='${tdStyle}'>${groupes[0]}</td><td style='${tdStyle}'>${groupes[1]}</td></tr><tr><td style='${tdStyle}'>${groupes[2]}</td></tr></tbody></table>`;break;case 'disposition-22':tdStyle='width:50%;';tpl=`<table class='${tableId}'><tbody><tr><td style='${tdStyle}'>${groupes[0]}</td><td style='${tdStyle}'>${groupes[1]}</td></tr><tr><td style='${tdStyle}'>${groupes[2]}</td><td style='${tdStyle}'>${groupes[3]}</td></tr></tbody></table>`;break;case 'disposition-30':tdStyle='width:100%;';tpl=`<table class='${tableId}'><tbody><tr><td style='${tdStyle}'>${groupes[0]}</td></tr><tr><td style='${tdStyle}'>${groupes[1]}</td></tr><tr><td style='${tdStyle}'>${groupes[2]}</td></tr></tbody></table>`;break;case 'disposition-31':tdStyle='width:50%;';tpl=`<table class='${tableId}'><tbody><tr><td colspan="1" rowspan="3" style='${tdStyle}'>${groupes[0]}</td><td style='${tdStyle}'>${groupes[1]}</td></tr><tr><td style='${tdStyle}'>${groupes[2]}</td></tr><tr><td style='${tdStyle}'>${groupes[3]}</td></tr></tbody></table>`;break;default:tpl=`tpl "${disposition}" non trouvé`;break;}return tpl;}}function ul_start(e,isDiv=false){e.dataTransfer.effectAllowed="move";e.dataTransfer.setData("text",e.target.getAttribute("id"));}function ulDaDGroups_dad_drop(e,mode=0){idFrom=e.dataTransfer.getData("text");e.currentTarget.parentNode.classList.remove('quiz_dad2');e.currentTarget.parentNode.classList.add('quiz_dad1');var obSource=document.getElementById(idFrom);var obDest=document.getElementById(e.currentTarget.getAttribute("id"));obDest.appendChild(obSource);computeAllScoreEvent();e.stopPropagation();return false;}function ulDaDGroups_dad_over(e){if(e.currentTarget.getAttribute("id")==e.dataTransfer.getData("text"))return false;e.currentTarget.parentNode.classList.remove('quiz_dad1');e.currentTarget.parentNode.classList.add('quiz_dad2');return false;}function ulDaDGroups_dad_leave(e){e.currentTarget.parentNode.classList.remove('quiz_dad2');e.currentTarget.parentNode.classList.add('quiz_dad1');}